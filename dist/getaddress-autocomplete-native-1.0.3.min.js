var getAddress=function(t){"use strict";function e(t,e,s,i){return new(s||(s=Promise))((function(n,o){function r(t){try{a(i.next(t))}catch(t){o(t)}}function u(t){try{a(i.throw(t))}catch(t){o(t)}}function a(t){var e;t.done?n(t.value):(e=t.value,e instanceof s?e:new s((function(t){t(e)}))).then(r,u)}a((i=i.apply(t,e||[])).next())}))}class s{constructor(t,s,i,n){this.input=t,this.client=s,this.output_fields=i,this.attributeValues=n,this.onInputFocus=()=>{this.attributeValues.options.select_on_focus&&this.input.select()},this.onInputPaste=()=>{setTimeout((()=>{this.populateList()}),100)},this.onInput=t=>{if(t instanceof InputEvent==0&&t.target instanceof HTMLInputElement){const e=t.target;Array.from(this.list.querySelectorAll("option")).every((t=>t.innerText!==e.value||(this.handleSuggestionSelected(t),!1)))}},this.onKeyUp=t=>{this.debug(t),this.handleKeyUp(t)},this.onKeyDown=t=>{this.debug(t),this.handleKeyDownDefault(t)},this.debug=t=>{this.attributeValues.options.debug&&console.log(t)},this.handleComponentBlur=(t=!1)=>{clearTimeout(this.blurTimer);const e=t?0:100;this.blurTimer=setTimeout((()=>{this.clearList()}),e)},this.handleSuggestionSelected=t=>e(this,void 0,void 0,(function*(){if(this.attributeValues.options.enable_get){this.input.value="",this.attributeValues.options.clear_list_on_select&&this.clearList();const e=t.dataset.id,s=yield this.client.get(e);if(s.isSuccess){let t=s.toSuccess();this.bind(t.address),class{static dispatch(t,e,s){const i=new Event("getaddress-autocomplete-address-selected",{bubbles:!0});i.address=s,i.id=e,t.dispatchEvent(i)}}.dispatch(this.input,e,t.address),this.attributeValues.options.input_focus_on_select&&(this.input.focus(),this.input.setSelectionRange(this.input.value.length,this.input.value.length+1))}else{const t=s.toFailed();(class{static dispatch(t,e,s,i){const n=new Event("getaddress-autocomplete-address-selected-failed",{bubbles:!0});n.status=s,n.message=i,n.id=e,t.dispatchEvent(n)}}).dispatch(this.input,e,t.status,t.message)}}else this.clearList()})),this.bind=t=>{t&&this.attributeValues.options.bind_output_fields&&(this.setOutputfield(this.output_fields.building_name,t.building_name),this.setOutputfield(this.output_fields.building_number,t.building_number),this.setOutputfield(this.output_fields.latitude,t.latitude.toString()),this.setOutputfield(this.output_fields.longitude,t.longitude.toString()),this.setOutputfield(this.output_fields.line_1,t.line_1),this.setOutputfield(this.output_fields.line_2,t.line_2),this.setOutputfield(this.output_fields.line_3,t.line_3),this.setOutputfield(this.output_fields.line_4,t.line_4),this.setOutputfield(this.output_fields.country,t.country),this.setOutputfield(this.output_fields.county,t.county),this.setOutputfield(this.output_fields.formatted_address_0,t.formatted_address[0]),this.setOutputfield(this.output_fields.formatted_address_1,t.formatted_address[1]),this.setOutputfield(this.output_fields.formatted_address_2,t.formatted_address[2]),this.setOutputfield(this.output_fields.formatted_address_3,t.formatted_address[3]),this.setOutputfield(this.output_fields.formatted_address_4,t.formatted_address[4]),this.setOutputfield(this.output_fields.town_or_city,t.town_or_city),this.setOutputfield(this.output_fields.locality,t.locality),this.setOutputfield(this.output_fields.district,t.district),this.setOutputfield(this.output_fields.residential,t.residential.toString()),this.setOutputfield(this.output_fields.sub_building_name,t.sub_building_name),this.setOutputfield(this.output_fields.sub_building_number,t.sub_building_number),this.setOutputfield(this.output_fields.thoroughfare,t.thoroughfare),this.setOutputfield(this.output_fields.postcode,t.postcode))},this.setOutputfield=(t,e)=>{if(!t)return;let s=document.getElementById(t);return s||(s=document.querySelector(t)),s&&(s instanceof HTMLInputElement?s.value=e:s.innerText=e),s},this.handleKeyDownDefault=t=>{t.key&&(1===t.key.length||"Unidentified"===t.key)&&(clearTimeout(this.filterTimer),this.filterTimer=setTimeout((()=>{this.input.value.length>=this.attributeValues.options.minimum_characters?this.populateList():this.clearList()}),this.attributeValues.options.delay))},this.handleKeyUp=t=>{if(("Backspace"===t.code||"Delete"===t.code)&&t){t.target==this.input&&(this.input.value.length<this.attributeValues.options.minimum_characters?this.clearList():this.populateList())}},this.populateList=()=>e(this,void 0,void 0,(function*(){var t;const e={all:!0,top:this.attributeValues.options.suggestion_count,template:"{formatted_address}{postcode,, }{postcode}"};this.attributeValues.options.filter&&(e.filter=this.attributeValues.options.filter);const s=null===(t=this.input.value)||void 0===t?void 0:t.trim(),i=yield this.client.autocomplete(s,e);if(i.isSuccess){const t=i.toSuccess(),e=[];if(t.suggestions.length){for(let s=0;s<t.suggestions.length;s++){const i=this.getListItem(t.suggestions[s]);e.push(i)}this.list.replaceChildren(...e)}else this.clearList();(class{static dispatch(t,e,s){const i=new Event("getaddress-autocomplete-suggestions",{bubbles:!0});i.suggestions=s,i.query=e,t.dispatchEvent(i)}}).dispatch(this.input,s,t.suggestions)}else{const t=i.toFailed();(class{static dispatch(t,e,s,i){const n=new Event("getaddress-autocomplete-suggestions-failed",{bubbles:!0});n.status=s,n.message=i,n.query=e,t.dispatchEvent(n)}}).dispatch(this.input,s,t.status,t.message)}})),this.clearList=()=>{this.list.replaceChildren()},this.getListItem=t=>{const e=document.createElement("OPTION");let s=t.address;return e.innerText=s,e.dataset.id=t.id,e}}destroy(){this.destroyInput(),this.destroyList()}destroyList(){this.list.remove()}destroyInput(){this.input.removeAttribute("list"),this.input.removeEventListener("focus",this.onInputFocus),this.input.removeEventListener("paste",this.onInputPaste),this.input.removeEventListener("keydown",this.onKeyDown),this.input.removeEventListener("keyup",this.onKeyUp),this.input.removeEventListener("input",this.onInput)}build(){this.input.setAttribute("list",`${this.attributeValues.listId}`),this.input.addEventListener("focus",this.onInputFocus),this.input.addEventListener("paste",this.onInputPaste),this.input.addEventListener("keydown",this.onKeyDown),this.input.addEventListener("keyup",this.onKeyUp),this.input.addEventListener("input",this.onInput),this.list=document.createElement("DATALIST"),this.list.id=this.attributeValues.listId,this.input.insertAdjacentElement("afterend",this.list)}}class i{constructor(t={}){this.id_prefix="getAddress-autocomplete-native",this.output_fields=void 0,this.delay=200,this.minimum_characters=2,this.clear_list_on_select=!0,this.select_on_focus=!0,this.alt_autocomplete_url=void 0,this.alt_get_url=void 0,this.suggestion_count=6,this.filter=void 0,this.bind_output_fields=!0,this.input_focus_on_select=!0,this.debug=!1,this.enable_get=!0,this.set_default_output_field_names=!0;for(const e in t)t.hasOwnProperty(e)&&void 0!==t[e]&&(this[e]=t[e])}}
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */var n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&(t[s]=e[s])},n(t,e)};function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function s(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(s.prototype=e.prototype,new s)}var r=function(){return r=Object.assign||function(t){for(var e,s=1,i=arguments.length;s<i;s++)for(var n in e=arguments[s])Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t},r.apply(this,arguments)};function u(t,e,s,i){return new(s||(s=Promise))((function(n,o){function r(t){try{a(i.next(t))}catch(t){o(t)}}function u(t){try{a(i.throw(t))}catch(t){o(t)}}function a(t){var e;t.done?n(t.value):(e=t.value,e instanceof s?e:new s((function(t){t(e)}))).then(r,u)}a((i=i.apply(t,e||[])).next())}))}function a(t,e){var s,i,n,o,r={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return o={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function u(o){return function(u){return function(o){if(s)throw new TypeError("Generator is already executing.");for(;r;)try{if(s=1,i&&(n=2&o[0]?i.return:o[0]?i.throw||((n=i.return)&&n.call(i),0):i.next)&&!(n=n.call(i,o[1])).done)return n;switch(i=0,n&&(o=[2&o[0],n.value]),o[0]){case 0:case 1:n=o;break;case 4:return r.label++,{value:o[1],done:!1};case 5:r.label++,i=o[1],o=[0];continue;case 7:o=r.ops.pop(),r.trys.pop();continue;default:if(!(n=r.trys,(n=n.length>0&&n[n.length-1])||6!==o[0]&&2!==o[0])){r=0;continue}if(3===o[0]&&(!n||o[1]>n[0]&&o[1]<n[3])){r.label=o[1];break}if(6===o[0]&&r.label<n[1]){r.label=n[1],n=o;break}if(n&&r.label<n[2]){r.label=n[2],r.ops.push(o);break}n[2]&&r.ops.pop(),r.trys.pop();continue}o=e.call(t,r)}catch(t){o=[6,t],i=0}finally{s=n=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,u])}}}var l=function(t){this.isSuccess=t},c=function(t){function e(){return t.call(this,!0)||this}return o(e,t),e}(l),h=function(t){function e(e){var s=t.call(this)||this;return s.suggestions=e,s}return o(e,t),e.prototype.toSuccess=function(){return this},e.prototype.toFailed=function(){throw new Error("Did not fail")},e}(c),d=function(t){function e(e){var s=t.call(this)||this;return s.suggestions=e,s}return o(e,t),e.prototype.toSuccess=function(){return this},e.prototype.toFailed=function(){throw new Error("Did not fail")},e}(c),p=function(t){function e(e){var s=t.call(this)||this;return s.address=e,s}return o(e,t),e.prototype.toSuccess=function(){return this},e.prototype.toFailed=function(){throw new Error("Did not fail")},e}(c),f=function(t){function e(e){var s=t.call(this)||this;return s.location=e,s}return o(e,t),e.prototype.toSuccess=function(){return this},e.prototype.toFailed=function(){throw new Error("Did not fail")},e}(c),_=function(t){function e(e,s){var i=t.call(this,!1)||this;return i.status=e,i.message=s,i}return o(e,t),e.prototype.toSuccess=function(){throw new Error("Not a success")},e.prototype.toFailed=function(){return this},e}(l),y=function(t){function e(e,s){var i=t.call(this,!1)||this;return i.status=e,i.message=s,i}return o(e,t),e.prototype.toSuccess=function(){throw new Error("Not a success")},e.prototype.toFailed=function(){return this},e}(l),g=function(t){function e(e,s){var i=t.call(this,!1)||this;return i.status=e,i.message=s,i}return o(e,t),e.prototype.toSuccess=function(){throw new Error("Not a success")},e.prototype.toFailed=function(){return this},e}(l),b=function(t){function e(e,s){var i=t.call(this,!1)||this;return i.status=e,i.message=s,i}return o(e,t),e.prototype.toSuccess=function(){throw new Error("Not a success")},e.prototype.toFailed=function(){return this},e}(l),m=function(t){function e(e){var s=t.call(this)||this;return s.addresses=e,s}return o(e,t),e.prototype.toSuccess=function(){return this},e.prototype.toFailed=function(){throw new Error("failed")},e}(c),v=function(t){function e(e,s){var i=t.call(this,!1)||this;return i.status=e,i.message=s,i}return o(e,t),e.prototype.toSuccess=function(){throw new Error("failed")},e.prototype.toFailed=function(){return this},e}(l),w=function(t){function e(e){var s=t.call(this)||this;return s.results=e,s}return o(e,t),e.prototype.toSuccess=function(){return this},e.prototype.toFailed=function(){throw new Error("failed")},e}(c),E=function(t){function e(e,s){var i=t.call(this,!1)||this;return i.status=e,i.message=s,i}return o(e,t),e.prototype.toSuccess=function(){throw new Error("failed")},e.prototype.toFailed=function(){return this},e}(l),R=function(){function t(t,e,s,i,n,o){void 0===e&&(e="https://api.getaddress.io/autocomplete/{query}"),void 0===s&&(s="https://api.getaddress.io/get/{id}"),void 0===i&&(i="https://api.getaddress.io/location/{query}"),void 0===n&&(n="https://api.getaddress.io/get-location/{id}"),void 0===o&&(o="https://api.getaddress.io/typeahead/{term}"),this.api_key=t,this.autocomplete_url=e,this.get_url=s,this.location_url=i,this.get_location_url=n,this.typeahead_url=o,this.autocompleteResponse=void 0,this.getResponse=void 0,this.locationResponse=void 0,this.getLocationResponse=void 0,this.typeaheadResponse=void 0,this.autocompleteAbortController=new AbortController,this.getAbortController=new AbortController,this.typeaheadAbortController=new AbortController,this.locationAbortController=new AbortController,this.getLocationAbortController=new AbortController}return t.prototype.location=function(t,e){return void 0===e&&(e={}),u(this,void 0,void 0,(function(){var s,i,n,o,u,l,c;return a(this,(function(a){switch(a.label){case 0:return a.trys.push([0,5,6,7]),s=r({all:!0},e),i=this.location_url.replace(/{query}/i,t),this.api_key&&(i=i.includes("?")?"".concat(i,"&api-key=").concat(this.api_key):"".concat(i,"?api-key=").concat(this.api_key)),void 0!==this.locationResponse&&(this.locationResponse=void 0,this.locationAbortController.abort(),this.locationAbortController=new AbortController),n=this,[4,fetch(i,{method:"post",signal:this.locationAbortController.signal,headers:{"Content-Type":"application/json"},body:JSON.stringify(s)})];case 1:return n.locationResponse=a.sent(),200!==this.locationResponse.status?[3,3]:[4,this.locationResponse.json()];case 2:return o=a.sent(),u=o.suggestions,[2,new d(u)];case 3:return[4,this.locationResponse.json()];case 4:return l=a.sent(),[2,new g(this.locationResponse.status,l.Message)];case 5:return(c=a.sent())instanceof Error?"AbortError"===c.name?[2,new d([])]:[2,new g(401,c.message)]:[2,new g(401,"Unauthorised")];case 6:return this.locationResponse=void 0,[7];case 7:return[2]}}))}))},t.prototype.getLocation=function(t){return u(this,void 0,void 0,(function(){var e,s,i,n,o;return a(this,(function(r){switch(r.label){case 0:return r.trys.push([0,5,6,7]),e=this.get_location_url.replace(/{id}/i,t),this.api_key&&(e=e.includes("?")?"".concat(e,"&api-key=").concat(this.api_key):"".concat(e,"?api-key=").concat(this.api_key)),void 0!==this.getLocationResponse&&(this.getResponse=void 0,this.getAbortController.abort(),this.getAbortController=new AbortController),s=this,[4,fetch(e,{method:"get",signal:this.getAbortController.signal,headers:{"Content-Type":"application/json"}})];case 1:return s.getResponse=r.sent(),200!==this.getResponse.status?[3,3]:[4,this.getResponse.json()];case 2:return i=r.sent(),[2,new f(i)];case 3:return[4,this.getResponse.json()];case 4:return n=r.sent(),[2,new _(this.getResponse.status,n.Message)];case 5:return(o=r.sent())instanceof Error?[2,new _(401,o.message)]:[2,new _(401,"Unauthorised")];case 6:return this.getResponse=void 0,[7];case 7:return[2]}}))}))},t.prototype.autocomplete=function(t,e){return void 0===e&&(e={}),u(this,void 0,void 0,(function(){var s,i,n,o,u,l,c;return a(this,(function(a){switch(a.label){case 0:return a.trys.push([0,5,6,7]),s=r({all:!0},e),i=this.autocomplete_url.replace(/{query}/i,t),this.api_key&&(i=i.includes("?")?"".concat(i,"&api-key=").concat(this.api_key):"".concat(i,"?api-key=").concat(this.api_key)),void 0!==this.autocompleteResponse&&(this.autocompleteResponse=void 0,this.autocompleteAbortController.abort(),this.autocompleteAbortController=new AbortController),n=this,[4,fetch(i,{method:"post",signal:this.autocompleteAbortController.signal,headers:{"Content-Type":"application/json"},body:JSON.stringify(s)})];case 1:return n.autocompleteResponse=a.sent(),200!==this.autocompleteResponse.status?[3,3]:[4,this.autocompleteResponse.json()];case 2:return o=a.sent(),u=o.suggestions,[2,new h(u)];case 3:return[4,this.autocompleteResponse.json()];case 4:return l=a.sent(),[2,new y(this.autocompleteResponse.status,l.Message)];case 5:return(c=a.sent())instanceof Error?"AbortError"===c.name?[2,new h([])]:[2,new y(401,c.message)]:[2,new y(401,"Unauthorised")];case 6:return this.autocompleteResponse=void 0,[7];case 7:return[2]}}))}))},t.prototype.get=function(t){return u(this,void 0,void 0,(function(){var e,s,i,n,o;return a(this,(function(r){switch(r.label){case 0:return r.trys.push([0,5,6,7]),e=this.get_url.replace(/{id}/i,t),this.api_key&&(e=e.includes("?")?"".concat(e,"&api-key=").concat(this.api_key):"".concat(e,"?api-key=").concat(this.api_key)),void 0!==this.getResponse&&(this.getResponse=void 0,this.getAbortController.abort(),this.getAbortController=new AbortController),s=this,[4,fetch(e,{method:"get",signal:this.getAbortController.signal,headers:{"Content-Type":"application/json"}})];case 1:return s.getResponse=r.sent(),200!==this.getResponse.status?[3,3]:[4,this.getResponse.json()];case 2:return i=r.sent(),[2,new p(i)];case 3:return[4,this.getResponse.json()];case 4:return n=r.sent(),[2,new b(this.getResponse.status,n.Message)];case 5:return(o=r.sent())instanceof Error?[2,new b(401,o.message)]:[2,new b(401,"Unauthorised")];case 6:return this.getResponse=void 0,[7];case 7:return[2]}}))}))},t.prototype.find=function(t){return u(this,void 0,void 0,(function(){var e,s,i,n;return a(this,(function(o){switch(o.label){case 0:return o.trys.push([0,5,,6]),[4,fetch("https://api.getaddress.io/find/".concat(t,"?api-key=").concat(this.api_key,"&expand=true"))];case 1:return 200!==(e=o.sent()).status?[3,3]:[4,e.json()];case 2:return s=o.sent(),[2,new m(s)];case 3:return[4,e.json()];case 4:return i=o.sent(),[2,new v(e.status,i.Message)];case 5:return(n=o.sent())instanceof Error?[2,new v(401,n.message)]:[2,new v(401,"Unauthorised")];case 6:return[2]}}))}))},t.prototype.typeahead=function(t,e){return void 0===e&&(e={}),u(this,void 0,void 0,(function(){var s,i,n,o,r;return a(this,(function(u){switch(u.label){case 0:return u.trys.push([0,5,6,7]),s=this.typeahead_url.replace(/{term}/i,t),this.api_key&&(s=s.includes("?")?"".concat(s,"&api-key=").concat(this.api_key):"".concat(s,"?api-key=").concat(this.api_key)),void 0!==this.typeaheadResponse&&(this.typeaheadResponse=void 0,this.typeaheadAbortController.abort(),this.typeaheadAbortController=new AbortController),i=this,[4,fetch(s,{method:"post",signal:this.autocompleteAbortController.signal,headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})];case 1:return i.typeaheadResponse=u.sent(),200!==this.typeaheadResponse.status?[3,3]:[4,this.typeaheadResponse.json()];case 2:return n=u.sent(),[2,new w(n)];case 3:return[4,this.typeaheadResponse.json()];case 4:return o=u.sent(),[2,new E(this.typeaheadResponse.status,o.Message)];case 5:return(r=u.sent())instanceof Error?"AbortError"===r.name?[2,new w([])]:[2,new E(401,r.message)]:[2,new E(401,"Unauthorised")];case 6:return this.typeaheadResponse=void 0,[7];case 7:return[2]}}))}))},t}();class A{constructor(t={},e){e&&this.setDefaultValues();for(const e in t)t.hasOwnProperty(e)&&void 0!==t[e]&&(this[e]=t[e])}setDefaultValues(){this.formatted_address_0="",this.formatted_address_1="formatted_address_1",this.formatted_address_2="formatted_address_2",this.formatted_address_3="formatted_address_3",this.formatted_address_4="formatted_address_4",this.line_1="line_1",this.line_2="line_2",this.line_3="line_3",this.line_4="line_4",this.town_or_city="town_or_city",this.county="county",this.country="country",this.postcode="postcode",this.latitude="latitude",this.longitude="longitude",this.building_number="building_number",this.building_name="building_name",this.sub_building_number="sub_building_number",this.sub_building_name="sub_building_name",this.thoroughfare="thoroughfare",this.locality="locality",this.district="district",this.residential="residential"}}class k{constructor(t,e){this.options=t;let s="";e>0&&(s=`-${e}`),this.id_prefix=t.id_prefix,this.listId=`${this.id_prefix}-list${s}`}}class O{static add(t){this.instances.push(t)}}return O.instances=[],t.autocomplete=function(t,e,n){if(!t)return;const o=new i(n);let r=document.getElementById(t);if(r||(r=document.querySelector(t)),!r)return;const u=new R(e,o.alt_autocomplete_url,o.alt_get_url),a=new A(o.output_fields,o.set_default_output_field_names);a.formatted_address_0||(a.formatted_address_0=t);const l=O.instances.length,c=new k(o,l),h=new s(r,u,a,c);h.build(),O.add(h)},t.destroy=function(){for(const t of O.instances)t.destroy();O.instances=[]},Object.defineProperty(t,"__esModule",{value:!0}),t}({});
